<ui:composition xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" 
	xmlns:jsf="http://xmlns.jcp.org/jsf"
	template="/paginas/template/template.xhtml">

	<ui:define name="conteudo">
		<h:panelGroup styleClass="col-md-9 column div-center">
			<h:panelGroup var="sprint" value="#{sprintDetalheMB.sprintSelecionada}">
				<h:commandLink immediate="true" action="#{sprintDetalheMB.sprintDetalhePage}">
					<h:outputText styleClass="label-page-title" value="#{sprintDetalheMB.sprintSelecionada.nome}" />
				</h:commandLink>
				<BR />
				<h:outputLabel styleClass="label-small" value="#{sprintDetalheMB.projetoSelecionado.nome}" />
				<BR />
				<h:outputLabel styleClass="label-small" value="#{mensagens.label_dataINI}" />
				<h:outputText styleClass="output-small" value="#{sprintDetalheMB.sprintSelecionada.dataInicioFormatada}" />
				<h:outputLabel value="|" styleClass="pipe-separator" />
				<h:outputLabel styleClass="label-small" value="#{mensagens.label_dataFIM}" />
				<h:outputText styleClass="output-small" value="#{sprintDetalheMB.sprintSelecionada.dataFimFormatada}" />
				<br />
				<br />
				<h:outputText styleClass="output-default" value="#{sprintDetalheMB.sprintSelecionada.descricao}" />
				<br />
				<br />
			</h:panelGroup>
			<p:tabView id="tabView" widgetVar="tabView">
			
				<!-- ABA DO DETALHE DA SPRINT -->			
				<p:tab id="tab1" title="Sprint Backlog" widgetVar="tab1">
					
					<p:dataGrid id="dtgSprintBacklog" widgetVar="dtgSprintBacklog" var="item" value="#{sprintDetalheMB.itens}" 
						columns="1" style="width:100%" emptyMessage="#{mensagens.mensagem_sem_registros}">
						<p:panel styleClass="col-md-12 column">
							
							<!-- CABEÇALHO DA LISTAGEM CONTENDO UM ITEM BACKLOG -->
							<f:facet name="header">
								<p:commandLink action="#{sprintDetalheMB.itembacklogDetalhePage}" immediate="true">
									<h:outputText styleClass="label-grid-header" value="#{item.nome}" />
									<f:setPropertyActionListener value="#{item}" target="#{sprintDetalheMB.itemSelecionado}" />
								</p:commandLink>								
								
								<!-- BOTAO NOVA TAREFA -->
								<p:commandLink action="#{itemBacklogDetalheMB.preparaParaInserir}" title="Nova tarefa"
									oncomplete="dlgTarefaSave.show()" process="@this" update="@widgetVar(dlgTarefaSave)"
									rendered="#{item.editable}" style="float: right">
									<i class="fa fa-plus inside-header-ico"/>										
									<f:setPropertyActionListener value="#{item}"
										target="#{itemBacklogDetalheMB.itemSelecionado}" />
								</p:commandLink>								
								
								<!-- BOTAO ENTREGAR ITEM -->
								<p:commandLink immediate="true" title="#{mensagens.mensagem_entregar_item}" 
									rendered="#{item.deliverable}"
									action="#{sprintDetalheMB.entregarItem}" update="@form">
									<i class="fa fa-check inside-header-icon"/>
									<f:setPropertyActionListener value="#{item}"
										target="#{sprintDetalheMB.itemSelecionado}" />
								</p:commandLink>
								
								<h:outputText styleClass="output-medium" value="#{item.statusItembacklog}" style="float: right;" />
								<br />
								<h:outputText styleClass="output-medium" value="#{item.descricao}" />
							</f:facet>													
						
						<p:dataGrid var="tarefa" value="#{item.tarefas}" columns="1" 
							style="width:100%" id="dataGridTarefas" widgetVar="dataGridTarefas"
							emptyMessage="#{mensagens.label_lista_de_tarefas_vazia}">
							<p:panel styleClass="col-md-12 column">
								<h:panelGroup styleClass="col-md-11 column">
									
									<h:outputText value="#{tarefa.nome}" />
									<h:outputText value="#{tarefa.situacaoDescricao}" style="color: white; float: right; #{tarefa.backgroundColor};" styleClass="label-medium"/>
									<br/>
									<h:outputText value="#{mensagens.label_responsavel} #{tarefa.usuario.nome}" rendered="#{not empty tarefa.usuario}" styleClass="output-small"/>
									<br/>
									
									<!-- BOTAO ATRIBUIR PARA MIM -->
									<p:commandLink id="linkAtribuirParaMim" title="#{mensagens.label_atribuir_para_mim}"
										action="#{sprintDetalheMB.atribuirTarefaParaMim}"										
										rendered="#{empty tarefa.usuario and tarefa.itemBacklog.editable}"
										immediate="true" process="@this" update="@widgetVar(dtgSprintBacklog)">
										<i class="fa fa-smile-o inside-grid-icon-left"></i>
										<f:setPropertyActionListener value="#{tarefa}"
											target="#{sprintDetalheMB.tarefaSelecionada}" />
										<f:setPropertyActionListener value="#{tarefa.itemBacklog}"
											target="#{sprintDetalheMB.itemSelecionado}" />
									</p:commandLink>
									
									<!-- BOTAO ATRIBUIR PARA OUTRO USUARIO -->
									<p:commandLink id="linkAtribuirPara" title="#{mensagens.label_atribuir_para}"
										action="#{itemBacklogDetalheMB.preparaParaAlterar}"
										oncomplete="dlgTarefaSave.show()" 
										process="@this" update="@widgetVar(dlgTarefaSave)"
										rendered="#{false}">
										<i class="fa fa-share-square-o inside-grid-icon-left"></i>
										<f:setPropertyActionListener value="#{tarefa}"
											target="#{sprintDetalheMB.tarefaSelecionada}" />
									</p:commandLink>
									
									<!-- BOTAO REPORTE DE HORAS -->
									<p:commandLink id="linkReporteHora" title="#{mensagens.label_reportar_hora}"
										action="#{itemBacklogDetalheMB.preparaParaAlterar}"
										oncomplete="dlgTarefaSave.show()" 
										process="@this" update="@widgetVar(dlgTarefaSave)"
										rendered="#{false}">
										<i class="fa fa-clock-o inside-grid-icon-left"></i>
										<f:setPropertyActionListener value="#{tarefa}"
											target="#{sprintDetalheMB.tarefaSelecionada}" />
									</p:commandLink>
									
									<!-- BOTAO ALTERAR SITUACAO -->
									<p:commandLink id="linkAlterarSituacao" title="#{mensagens.label_alterar_situacao}"
										action="#{itemBacklogDetalheMB.preparaParaAlterar}"
										oncomplete="dlgTarefaSave.show()" 
										process="@this" update="@widgetVar(dlgTarefaSave)"
										rendered="#{false}">
										<i class="fa fa-pencil inside-grid-icon-left"></i>
										<f:setPropertyActionListener value="#{tarefa}"
											target="#{sprintDetalheMB.tarefaSelecionada}" />
									</p:commandLink>
									
									<!-- BOTAO FAVORITAR TAREFA -->									
									<p:commandLink id="linkFavoritarTarefa" title="#{mensagens.label_favoritar_tarefa}"
										action="#{itemBacklogDetalheMB.preparaParaAlterar}"
										oncomplete="dlgTarefaSave.show()" 
										process="@this" update="@widgetVar(dlgTarefaSave)"
										rendered="#{false}">
										<i class="fa fa-star-o inside-grid-icon-left"></i>
										<f:setPropertyActionListener value="#{tarefa}"
											target="#{sprintDetalheMB.tarefaSelecionada}" />
									</p:commandLink>
								</h:panelGroup>
								<h:panelGroup styleClass="col-md-1 column">
								
									<!-- BOTAO ALTERAR TAREFA -->																
									<p:commandLink id="alterarTarefaLink" title="#{mensagens.label_alterar_tarefa}"
										action="#{itemBacklogDetalheMB.preparaParaAlterar}"
										oncomplete="dlgTarefaSave.show()" 
										process="@this" 
										update="@widgetVar(dlgTarefaSave)"
										rendered="#{! tarefa.estahConcluida}">
										<h:outputText styleClass="fa fa-pencil-square-o inside-grid-icon" />
										<f:setPropertyActionListener value="#{tarefa}"
											target="#{itemBacklogDetalheMB.tarefaSelecionada}" />
									</p:commandLink>
									<br />
									
									<!-- BOTAO EXCLUIR TAREFA -->									
									<p:commandLink id="removerTarefaLink" immediate="true"
										title="#{mensagens.label_remover_tarefa}"
										action="#{itemBacklogDetalheMB.removerTarefa}" 
										process="@this" update="@widgetVar(dtgSprintBacklog)"
										rendered="#{! tarefa.estahConcluida}">
										<h:outputText styleClass="fa fa-trash-o inside-grid-icon" />
										<f:setPropertyActionListener value="#{tarefa}"
											target="#{itemBacklogDetalheMB.tarefaSelecionada}" />
										<f:setPropertyActionListener value="#{tarefa.itemBacklog}"
											target="#{itemBacklogDetalheMB.itemSelecionado}" />
										<p:confirm header="#{mensagens.label_remover_tarefa}" 
											message="#{mensagens.mensagem_tarefa_sera_removida}" icon="ui-icon-alert"/>
									</p:commandLink>									
																		
								</h:panelGroup>
							</p:panel>
							<h:panelGroup class="col-md-3 column"></h:panelGroup>
						</p:dataGrid>
						</p:panel>
					</p:dataGrid>
					
					<!-- DIÁLOGO DA EXCLUSÃO DA TAREFA -->					
					<p:confirmDialog global="true" showEffect="fade" hideEffect="explode"> 
						<p:commandButton value="#{mensagens.botao_cancelar}" styleClass="ui-confirmdialog-no" 
							icon="ui-icon-close" immediate="true" style="margin:0 auto; float:right"/>  
		        		<p:commandButton value="#{mensagens.botao_confirmar}" styleClass="ui-confirmdialog-yes" 
		        			icon="ui-icon-check" immediate="true" style="margin:0 auto; float:right"/>        		      
		    		</p:confirmDialog>    		
				</p:tab>
				
				<!-- ABA DO SPRINT BOARD -->				
				<p:tab id="tab2" title="Sprint Board">
					<h:panelGrid columns="2" cellpadding="10">
						<h:outputText id="tab2Text" value="Aqui sera criado o Board da Sprint" />
					</h:panelGrid>
				</p:tab>
				
				<!-- ABA DOS GRÁFICOS BURNUP E BURNDOWN -->				
				<p:tab id="tab3" title="Gráficos">
					<h:panelGrid columns="2" cellpadding="10">
						<h:outputText id="tab3Text" value="Aqui sera criado o grafico de burndown e burnup da sprint" />
					</h:panelGrid>
				</p:tab>
				
				<!-- ABA DO DAILY SCRUM -->
				<p:tab id="tab4" title="Daily Scrum">
					<h:panelGroup id="dailyPanel">
						<br />						
						<p:dataGrid 
						id="tabelaDaily"
						var="dailyScrum"
						value="#{sprintDetalheMB.dailies}" 
						columns="5"
						style="width:100%;" >
								
								<f:facet name="header">
									<h:outputText value="#{mensagens.label_dailies_cadastrados}" />
								</f:facet>
								
								<p:panel header="#{dailyScrum.dataFormatada}">
									<p:outputLabel for="dailyHorario" value="#{mensagens.label_horario_daily}" style="font-size: 12px;"/> <span/>
									<h:outputText id="dailyHorario" value="#{dailyScrum.horaFormatada}"  style="font-size: 12px;"/>  <br/>
									<p:outputLabel for="dailyLocal" value="#{mensagens.label_local_daily}"  style="font-size: 12px;"/> <span/>
									<h:outputText id="dailyLocal" value="#{dailyScrum.local}"  style="font-size: 12px;"/>  <br/>
									<p:outputLabel for="dailyDuracao" value="#{mensagens.label_duracao_daily}" style="font-size: 12px;"/> <span/>
									<h:outputText id="dailyDuracao" value="#{dailyScrum.duracao} min" style="font-size: 12px;"/> <br/>
									<f:facet name="footer">
									  <div align="center">
										<p:commandButton 
											id="alterarBotao"
											value="#{mensagens.botao_alterar}"
											action="#{sprintDetalheMB.alterarDailyScrum}"
											oncomplete="dailyScrumModal.show()"
											process="@this"
											update="@widgetVar(dailyScrumModal)" >											
											<f:setPropertyActionListener value="#{dailyScrum}" target="#{sprintDetalheMB.dailyScrumSelecionado}" />
										</p:commandButton>
										<br/>
										<p:commandButton 
										    id="excluirBotao"
											value="#{mensagens.botao_excluir}" 
											process="@this"
											update="@widgetVar(confimExcluir)" 
											oncomplete="confimExcluir.show()"
											style="top: 5px;" >											
											<f:setPropertyActionListener value="#{dailyScrum}" target="#{sprintDetalheMB.dailyScrum}" />
										</p:commandButton>
										</div>
									</f:facet>
								</p:panel>								
								
								<f:facet name="footer">
									<p:commandButton 
										id="cadastrarBotao"
										value="#{mensagens.botao_cadastrar}"
										oncomplete="dailyScrumModal.show()"
										process="@this"
										update="@widgetVar(dailyScrumModal)"
										action="#{sprintDetalheMB.novoDaily}" />
								</f:facet>	
						</p:dataGrid>
							
							<p:confirmDialog 
							   id="confimExcluir" 
							   widgetVar="confimExcluir" 
							   message="#{mensagens.mensagem_info_daily_sera_excluido}">
							     
			        			<p:commandButton 
			        			   id="confirmButton"
			        			   value="#{mensagens.botao_confirmar}" 
			        			   styleClass="ui-confirmdialog-yes" 
			        			   icon="ui-icon-check" 
			        			   action="#{sprintDetalheMB.excluirDaily}" 
			        			   oncomplete="confimExcluir.hide()" 
			        			   update="@form" />  
			        			
			        			<p:commandButton 
			        			   id="cancelarButton"
			        			   value="#{mensagens.botao_cancelar}" 
			        			   styleClass="ui-confirmdialog-no" 
			        			   icon="ui-icon-close"
			        			   oncomplete="confimExcluir.hide()" />			        			          
			    			</p:confirmDialog>
		
							<!-- INCLUDE DO MODAL DO CADASTRO DE DAILY SCRUM -->
							<ui:include src="/paginas/dailyscrum/dailyscrumcadastro.xhtml" />
											
					</h:panelGroup>
				</p:tab>
				
			</p:tabView>
		</h:panelGroup>
		
		<!-- BARRA LATERAL DIREITA -->
		
		<h:panelGroup styleClass="col-md-3 column div-right">
			<h:outputText value="Time do projeto" />
		</h:panelGroup>
		<!-- INCLUDE DO MODAL DO CADASTRO DE DAILY SCRUM -->
		<ui:include src="/paginas/dailyscrum/dailyscrumcadastro.xhtml" />
		<!-- INCLUDE DO MODAL DO CADASTRO DE TAREFA -->		
		<ui:include src="/paginas/tarefa/tarefaSave.xhtml" />
		
	</ui:define>
	
	<!-- MENU LATERAL -->
	
	<ui:define name="menu_lateral">
		<li><h:commandLink immediate="true" action="#{sprintDetalheMB.itemBacklogPage}">
				<i class="fa fa-list left-sidebar-icon" />
				<h:outputText value="#{mensagens.label_backlog}" />
			</h:commandLink></li>
		<li><h:commandLink immediate="true" action="#{sprintDetalheMB.sprintPage}">
				<i class="fa fa-bar-chart-o left-sidebar-icon" />
				<h:outputText value="#{mensagens.label_sprint}" />
			</h:commandLink></li>
	</ui:define>
	
</ui:composition>
